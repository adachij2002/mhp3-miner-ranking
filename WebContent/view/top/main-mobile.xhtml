<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
<ui:composition template="../templates/layout.xhtml">
	<ui:define name="content">
		<h:form id="top_main" prependId="false">
			<h:panelGroup id="headerPanelLogin" rendered="#{accountManager.loggedIn}" >
				<ul data-role="listview">
					<li data-role="list-divider">
						<h:outputFormat value="#{msg['label.common.welcome']}" >
							<f:param value="#{accountManager.loginUser.mhName}"/>
						</h:outputFormat>
					</li>
				</ul>
			</h:panelGroup>
			<h:panelGroup id="headerPanelNotLogin" rendered="#{not accountManager.loggedIn}" >
				<ul data-role="listview">
					<li data-role="list-divider">
						<h:link id="login_cmd" outcome="/view/top/login" >
							<h:outputText value="#{msg['nav.common.login']}"/>
						</h:link>
					</li>
				</ul>
			</h:panelGroup>
			<h3>
				<h:outputText value="#{msg['label.top.main.list']}"/>
				<span id="workingIndicator" class="status" style="display: none;">
					<img src="../images/ajax-loader.gif" />
				</span>
			</h3>
			<h:panelGroup id="listPanel">
				<h:panelGroup id="navPanelTop" rendered="#{not empty top.minerRankings}">
					<div class="align_left" >
						<h:commandLink id="prevTop" value="#{msg['nav.common.prev']}"
							action="#{top.previousPage}"
							disabled="#{top.minerRankingSearchParam.pageIndex le 0}">
							<f:ajax render="listPanel" onevent="showWorkingIndicator"/>
						</h:commandLink>
					</div>
					<div class="align_right" >
						<h:commandLink id="nextTop" value="#{msg['nav.common.next']}"
							action="#{top.nextPage}"
							disabled="#{top.minerRankingSearchParam.pageIndex * top.minerRankingSearchParam.pageSize + top.minerRankingSearchParam.pageSize >= top.resultCount}">
							<f:ajax render="listPanel" onevent="showWorkingIndicator"/>
						</h:commandLink>
					</div>
				</h:panelGroup>
				<h:dataTable
					id="dataTable"
					value="#{top.minerRankings}"
					var="minerRanking"
					border="1"
					rendered="#{not empty top.minerRankings}"
					styleClass="list_table"
					columnClasses="num_column, mhname_column, amuletcount_column"
					rowClasses="gray_row, white_row" >
					<h:column>
						<f:facet name="header">
							<h:outputText value="#{msg['label.top.main.list.num']}"/>
						</f:facet>
						<h:outputText value="#{top.minerRankingSearchParam.pageIndex * top.minerRankingSearchParam.pageSize + top.minerRankings.rowIndex + 1}"/>
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="#{msg['label.top.main.list.mhname']}"/>
						</f:facet>
						<h:outputText value="#{minerRanking.mhName}"/>
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="#{msg['label.top.main.list.amuletcount']}"/>
						</f:facet>
						<h:outputText value="#{minerRanking.amuletCount}"/>
					</h:column>
				</h:dataTable>
			</h:panelGroup>
			<br />
			<h:panelGroup id="footerPanelLogin" rendered="#{accountManager.loggedIn}" >
				<ul data-role="listview">
					<li>
						<h:link id="editmining_cmd" value="#{msg['nav.common.editmining']}" outcome="/view/config/mining" />
					</li>
					<li>
						<h:link id="edituser_cmd" value="#{msg['nav.common.edituser']}" outcome="/view/config/user" />
					</li>
					<li>
						<a href="#{msg['url.top.main.routemap']}" >
							<h:outputText value="#{msg['label.top.main.routemap']}" />
						</a>
					</li>
					<li>
						<h:commandLink id="logout_cmd" value="#{msg['nav.common.logout']}" action="#{accountManager.logout}" immediate="true" />
					</li>
				</ul>
			</h:panelGroup>
			<h:panelGroup id="footerPanelNotLogin" rendered="#{not accountManager.loggedIn}" >
				<ul data-role="listview">
					<li>
						<h:link id="createuser_cmd" value="#{msg['nav.common.createuser']}" outcome="/view/config/user" />
					</li>
					<li>
						<h:link id="listmining_cmd" value="#{msg['nav.common.listmining']}" outcome="/view/config/mining" />
					</li>
					<li>
						<a href="#{msg['url.top.main.routemap']}" >
							<h:outputText value="#{msg['label.top.main.routemap']}" />
						</a>
					</li>
				</ul>
			</h:panelGroup>
			<!-- for IE bug -->
			<h:inputText style="visibility:hidden;display:none;" disabled="true" required="false" />
		</h:form>
	</ui:define>
</ui:composition>
</html>
